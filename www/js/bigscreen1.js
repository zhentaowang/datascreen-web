/*! longteng (c) 2016 
	Author: Renzhao
*/
function getMinuteData(a){var e=User.appendAccessToken({date:a});$.ajax({url:server+"custom/lounge/portrait",type:"POST",data:JSON.stringify(e),success:function(a){getRestInfo(a.continentTrafficSite)}}),$.ajax({url:server+"getCustomDataCount",type:"POST",data:JSON.stringify(e),success:function(a){vm.personNumber=a.count}}),$.ajax({url:server+"getDragonCardCount",type:"POST",data:JSON.stringify(e),success:function(a){vm.vipNumber=a.count}}),$.ajax({url:server+"dragonCardConsumeDateAgency",type:"POST",data:JSON.stringify(e),success:function(a){vm.agency=a}})}function getRestInfo(a){a.forEach(function(a){a.data.forEach(function(a){1===a.increase?a.type="up":(a.type="down",a.style={transform:"rotate(180deg)"})})}),vm.rest=a}function getNowData(){var a=User.appendAccessToken({date:(new Date).getTime()-1728e5});$.ajax({url:server+"evolutionDate",type:"POST",data:JSON.stringify(a),success:function(a){var e=a.dayNum.map(function(a){return getYueRi(new Date(a.date))}),t=a.dayNum.map(function(a){return a.consumeNum}),n=a.monthNum.map(function(a){return getNianYue(new Date(a.date))}),r=a.monthNum.map(function(a){return a.cardNum});lineChart(e,t,"consumeChart"),lineChart(n,r,"cardChart")}}),$.ajax({url:server+"getEcom2gCustomDataCount",type:"POST",data:JSON.stringify(a),success:function(a){var e=a.carbill.map(function(a){return getYueRi(new Date(a.consume_time))}),t=a.carbill.map(function(a){return a.order_num}),n=a.channelbill.map(function(a){return a.order_num}),r=a.restaurant.map(function(a){return a.order_num});lineChart(e,t,"carbill"),lineChart(e,n,"channelbill"),lineChart(e,r,"restaurant")}}),$.ajax({url:server+"getSpecialLoungeConsumeEvolutionDate",type:"POST",data:JSON.stringify(a),success:function(a){var e=a.data.map(function(a){return getYueRi(new Date(a.date))});a=a.data.map(function(a){return a.num}),lineChart(e,a,"specialConsumeChart")}}),$.ajax({url:server+"getSpecialAirPortConsumeEvolutionDate",type:"POST",data:JSON.stringify(a),success:function(a){var e=a.data.map(function(a){return getYueRi(new Date(a.date))});a=a.data.map(function(a){return a.num}),lineChart(e,a,"specialAirPortChart")}}),$.ajax({url:server+"getSpecialLoungeConsumeDate",type:"POST",data:JSON.stringify(a),success:function(a){a.data.forEach(function(a){vm.specialConsumeDate.push(a)})}}),$.ajax({url:server+"getSpecialAirPortConsumeDate ",type:"POST",data:JSON.stringify(a),success:function(a){a.data.forEach(function(a){vm.specialAirPortDate.push(a)})}})}function lineChart(a,e,t){var n=echarts.init(document.getElementById(t),"macarons"),r={tooltip:{trigger:"axis",formatter:"{b}<br />{c}"},backgroundColor:"#0a284e",color:["#fa836d","#a6d25f"],grid:{left:"3%",right:"4%",bottom:"3%",top:"10%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,axisLabel:{textStyle:{color:"#fff"}},axisLine:{lineStyle:{color:"#fff"}},data:a},yAxis:{type:"value",axisLabel:{textStyle:{color:"#fff"}},axisLine:{lineStyle:{color:"#fff"}},splitLine:{show:!1}},series:[{name:"",type:"line",smooth:!0,markPoint:{data:[{name:"",value:e[e.length-1],xAxis:e.length-1,yAxis:e[e.length-1],symbolOffset:[0,20]}]},data:e}]};n.setOption(r,!0)}function startFade(a,e){function t(a){o.eq(a).stop(!0,!1).animate({opacity:"1"},300).siblings().stop(!0,!1).animate({opacity:"0"},300),r.eq(a).addClass("active").siblings().removeClass("active")}var n,r=a.children(".float-right").children("li"),i=a.children(".nav").children("li"),o=a.children(".content").children("li"),s=o.length,u=(a.width,0);clearInterval(n),e&&a.hover(function(){clearInterval(n)},function(){n=setInterval(function(){t(u),u++,u==s&&(u=0)},1e4)}).trigger("mouseleave"),i.click(function(){$(this).addClass("active").siblings().removeClass("active");var a=i.index(this);t(a)}),r.click(function(){$(this).addClass("active").siblings().removeClass("active");var a=r.index(this);t(a)})}function randomData(){return Math.round(2500*Math.random())}function drawChartMap(){var a=echarts.init(document.getElementById("chinaMap")),e={tooltip:{trigger:"item",formatter:"{b} : {c}"},visualMap:{seriesIndex:0,min:0,max:2500,left:"left",top:"bottom",text:["高","低"],calculable:!0},grid:{height:200,width:8,right:80,bottom:10},xAxis:{type:"category",data:[],splitNumber:1,show:!1},yAxis:{position:"right",min:0,max:20,splitNumber:20,inverse:!0,axisLabel:{show:!0},axisLine:{show:!1},splitLine:{show:!1},axisTick:{show:!1},data:[]},series:[{zlevel:1,name:"中国",type:"map",mapType:"china",selectedMode:"multiple",roam:!0,left:"10%",right:"15%",label:{normal:{show:!1},emphasis:{show:!0}},data:[{name:"北京",value:randomData()},{name:"天津",value:randomData()},{name:"上海",value:randomData()},{name:"重庆",value:randomData()},{name:"河北",value:randomData()},{name:"河南",value:randomData()},{name:"云南",value:randomData()},{name:"辽宁",value:randomData()},{name:"黑龙江",value:randomData()},{name:"湖南",value:randomData()},{name:"安徽",value:randomData()},{name:"山东",value:randomData()},{name:"新疆",value:randomData()},{name:"江苏",value:randomData()},{name:"浙江",value:randomData()},{name:"江西",value:randomData()},{name:"湖北",value:randomData()},{name:"广西",value:randomData()},{name:"甘肃",value:randomData()},{name:"山西",value:randomData()},{name:"内蒙古",value:randomData()},{name:"陕西",value:randomData()},{name:"吉林",value:randomData()},{name:"福建",value:randomData()},{name:"贵州",value:randomData()},{name:"广东",value:randomData()},{name:"青海",value:randomData()},{name:"西藏",value:randomData()},{name:"四川",value:randomData()},{name:"宁夏",value:randomData()},{name:"海南",value:randomData()},{name:"台湾",value:randomData()},{name:"香港",value:randomData()},{name:"澳门",value:randomData()}]}]};a.setOption(e)}User.isLogin()||(document.location.href="login.html");var vm=new Vue({el:"body",data:{vipNumber:"",personNumber:"",time:"",rest:"",agency:"",specialConsumeDate:[],specialAirPortDate:[]}});drawChartMap(),startFade($("#leftFade"),!0),startFade($("#rightFade"),!0),getMinuteData((new Date).getTime()-1728e5),function(){function a(){var a=new Date((new Date).getTime()-1728e5);vm.time=getLocalDay(a)+" "+getLocalTime(a),4===a.getHours()&&a.getMinutes()===a.getSeconds()===0&&getDayData(),0===a.getSeconds()&&getMinuteData(a.getTime())}var e;e=setInterval(a,1e3),$(".start-pause").click(function(){var t=$(".pause").hasClass("start");t?($(".pause").removeClass("start"),e=setInterval(a,1e3)):($(".pause").addClass("start"),clearInterval(e))})}();